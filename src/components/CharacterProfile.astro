---
import { Image } from "astro:assets";

import Card from "@/components/ui/Card.astro";
import LabeledValue from "@/components/ui/LabeledValue.astro";
import HandWritingBlock from "@/components/ui/HandWritingBlock.astro";
import Scroller from "@/components/ui/client/Scroller.vue";
import { getEntry } from "astro:content";
import { localizePath } from "../utils/locale";

const profile = await getEntry("profile", localizePath(Astro, "profile"))!;
const scroller = await getEntry(
  "section",
  localizePath(Astro, profile.data.scroller)
)!;
---

<section
  id="characterProfile"
  class="flex h-dvh min-h-dvh max-w-full snap-center flex-col justify-center gap-6 md:pt-16"
>
  <div class="flex items-center justify-center gap-6 max-md:flex-col-reverse">
    <div
      style="animation-delay: 450ms"
      class="animate-fade-right my-auto flex flex-col gap-1 max-md:w-full max-md:max-w-md max-md:px-8"
    >
      {
        profile.data.facts.map(fact => (
          <LabeledValue id={fact.id} label={fact.label}>
            {fact.value}
          </LabeledValue>
        ))
      }
    </div>
    <Card class="animate animate-zoom-in aspect-square max-w-lg">
      <Image
        src={profile.data.picture}
        alt="Avatar"
        loading="eager"
        fetchpriority="high"
        layout="constrained"
        width="504"
        height="504"
      />
    </Card>
    <div class="flex w-80 min-w-64 flex-col justify-center gap-4 max-lg:hidden">
      {
        profile.data.traits.map((trait, idx) => (
          <HandWritingBlock
            label={trait.label}
            class="animate-flip-in"
            style={`animation-delay: ${150 * (idx + 2)}ms`}
          >
            {trait.value.map(value => (
              <span>{value}</span>
            ))}
          </HandWritingBlock>
        ))
      }
    </div>
  </div>
  <Scroller
    style="animation-delay: 750ms"
    class="animate-zoom-in max-md:hidden"
    elementId={scroller.data.target}
    client:load
  >
    {scroller.data.prompt}
  </Scroller>
</section>
